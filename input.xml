<?xml version="1.0" encoding="UTF-8"?>
<class>

    <loginDetails>
      <dbURL>jdbc:sqlserver://10.255.72.24:1433;databaseName=Abacus</dbURL>
      <username>Abacusi</username> 
      <password>2dPPHPVT</password>     

   </loginDetails>
   
   <AddSupplyPersonalNo>
    
    <Query>select distinct top 1 rs_personnel_no from resprojects  WITH (NOLOCK)
			inner join resource  WITH (NOLOCK) on rp_rs_id=rs_id  and rp_curr_yn='Y'
			inner join opsourcingdetails  WITH (NOLOCK) on osd_id=rp_osd_id and osd_activeyn='Y' 
			where rp_pr_id=1 AND rs_status='O' AND rs_personnel_no is not null</Query>
   
   </AddSupplyPersonalNo>
   
   <AddSupplyRRD>
    
    <Query>SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
			WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y'
			ORDER BY 1 DESC</Query>
   
   </AddSupplyRRD>
      
   <DemandCancellationRRD>
    
    <Query>   SELECT  TOP 1 OSD_ID
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID!=1 AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NOT NULL 
ORDER BY 1 DESC
    </Query>
   
   </DemandCancellationRRD>
   
    <DemandCloneRRD>
    
    <Query>	SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
			WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
			ORDER BY 1 DESC
    </Query>
   
   </DemandCloneRRD>
   
     <MatchingRoleRRD>
    
    <Query>	SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
			WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
			ORDER BY 1 DESC
    </Query>
   
   </MatchingRoleRRD>
   
   <PendingApproval>
   
   <Query>SELECT TOP 1 UOSD_ID from unapprovedosd WITH (NOLOCK) where UOSD_OS_ID=1</Query>
   
    </PendingApproval>

 
    <QuickEditRRD>
   		  
			<Query>SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
				WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
				ORDER BY 1 DESC</Query>
	</QuickEditRRD>	
	
	
	  <GeneralEditRRD>
   		  
			<Query>SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
				WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
				ORDER BY 1 DESC</Query>
	</GeneralEditRRD>	
	
	<demandCloneRRD>
	
		<Query>SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
					WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
					ORDER BY 1 DESC</Query>
					
		    
	</demandCloneRRD>
	
	<demandCloneEnterpriseID>
	
		<Query>SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
					WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
					ORDER BY 1 DESC</Query>
					
		    
	</demandCloneEnterpriseID>
	
	<AddSupplyTagPersonalNo>
    
    <Query>	select top 1 distinct rs_personnel_no from resprojects  WITH (NOLOCK)
			inner join resource  WITH (NOLOCK) on rp_rs_id=rs_id  and rp_curr_yn='Y'
			inner join opsourcingdetails  WITH (NOLOCK) on osd_id=rp_osd_id and osd_activeyn='Y' 
			where rp_pr_id=1</Query>
   
   </AddSupplyTagPersonalNo>
   
      <AddSupplyTagRRD>
    
    <Query>	SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
			WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y'
			ORDER BY 1 DESC    </Query>
   
   </AddSupplyTagRRD>


	<Transfer1RRD>

	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Mumbai'
                AND ACG_NAME='CIO'
                AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer1RRD>
	
	<Transfer1PersonnelNo>
	<Query>SELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE 
--RL_NAME='10'
                 Ol_name!='Mumbai'
                AND ACG_NAME='CIO'
                --AND DU_NO='CIO05'   
                AND RS_STATUS ='O'
                AND RP_OSD_ID=1
ORDER BY 1 DESC
    </Query>
	</Transfer1PersonnelNo>
	
 <Transfer2RRD>
	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Mumbai'
                AND ACG_NAME='CIO'
                AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer2RRD>
	
	<Transfer2PersonnelNo>
	<Query>SELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE 
--RL_NAME='10'
                 Ol_name!='Mumbai'
                AND ACG_NAME!='CIO'
                --AND DU_NO='CIO05'   
                AND RS_STATUS ='O'
                AND RP_OSD_ID=1
ORDER BY 1 DESC
    </Query>
	</Transfer2PersonnelNo>
 
  <Transfer3RRD>

	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name!='Bengaluru'
                AND ACG_NAME='CIO'
               -- AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer3RRD>
	
	<Transfer3PersonnelNo>
	<Query>SELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE
-- RL_NAME='10'
                 Ol_name='Bengaluru'
                AND ACG_NAME='CIO'
                AND DU_NO='CIO05'   
                AND RS_STATUS ='O'
                AND RP_OSD_ID=1
ORDER BY 1 DESC
    </Query>
	</Transfer3PersonnelNo>
 
  
    <Transfer4RRD>

	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name!='Bengaluru'
                AND ACG_NAME='CIO'
                AND DU_NO!='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer4RRD>
  <Transfer5RRD>

	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name!='Bengaluru'
                AND ACG_NAME='RES'
               -- AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer5RRD>
	
	<Transfer6aRRD>
	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name!='Mumbai'
                AND ACG_NAME!='FS'
               -- AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer6aRRD>
	
	<Transfer6aPersonnelNo>
	<Query>SELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE 
--RL_NAME='10'
                 Ol_name='Mumbai'
                AND ACG_NAME ='FS'
               -- AND DU_NO='CIO05'   
                AND RS_STATUS ='O'
                AND RP_OSD_ID=1
ORDER BY 1 DESC
    </Query>
	</Transfer6aPersonnelNo>
 	
	<Transfer6bRRD>
		<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Mumbai'
                AND ACG_NAME='FS'
              --  AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC 

</Query>
	</Transfer6bRRD>
	
	<Transfer7aRRD>
	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Chennai'
                AND ACG_NAME='CIO'
                AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC </Query>
	</Transfer7aRRD>
	
	<Transfer7aPersonnelNo>
	<Query>ELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE RL_NAME='12'
                AND Ol_name='Mumbai'
                --AND ACG_NAME='CIO'
               -- AND DU_NO='CIO05'   
                AND RS_STATUS ='O'
                AND RP_OSD_ID=1
ORDER BY 1 DESC
    </Query>
    </Transfer7aPersonnelNo>
	<Transfer7bRRD>
	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Bengaluru'
                AND ACG_NAME='CIO'
                AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC</Query>
	</Transfer7bRRD>
	
		<Transfer8aRRD>
	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Chennai'
                AND ACG_NAME='CIO'
               -- AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC</Query>
	</Transfer8aRRD>
	
	<Transfer8aPersonnelNo>
	<Query>SELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE RL_NAME='12'
                AND Ol_name='Chennai'
                AND ACG_NAME='CIO'
               -- AND DU_NO='CIO05'   
                AND RS_STATUS ='O'
                AND RP_OSD_ID=1
ORDER BY 1 DESC
    </Query>
    </Transfer8aPersonnelNo>
	<Transfer8bRRD>
	<Query>SELECT TOP 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='10'
                AND Ol_name='Bengaluru'
                AND ACG_NAME='FS'
               -- AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
ORDER BY 1 DESC</Query>
	</Transfer8bRRD>
	
	
	<Transfer9RRD>
	<Query>SELECT DISTINCT ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
	 FROM  APPUSER WITH (NOLOCK) 
	 INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y' AND UGM_ACTIVEYN='Y'
	 INNER JOIN DUMASTER WITH (NOLOCK) ON DU_ID=UGM_DETAIL_ID AND DU_ACTIVEYN='Y'  AND UGM_UG_ID=4
	 INNER JOIN RESOURCE WITH (NOLOCK) ON DU_NO=RS_DU_NO 
	 INNER JOIN [DBO].[TRANSFER_DETAILS] WITH (NOLOCK) ON TIR_RS_ID=RS_ID
	 INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) ON TIR_OSD_ID=OSD_ID AND OSD_ACTIVEYN='Y' AND OSD_OS_ID=1
	 INNER JOIN [DBO].[TRANSFER_MASTER] WITH (NOLOCK) ON TM_ID=TIR_TRANS_TYPE_TM_ID AND TM_ACTIVEYN='Y'
	WHERE TM_CATG='TIRTYPE' AND TM_NAME='DEPUTATION'</Query></Transfer9RRD>
	<Transfer9PersonnelNo>
	<Query>SELECT DISTINCT RS_PERSONNEL_NO,PR_NAME FROM RESOURCE WITH (NOLOCK)
INNER JOIN [DBO].[TRANSFER_DETAILS] WITH (NOLOCK) ON TIR_RS_ID=RS_ID
INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) ON TIR_OSD_ID=OSD_ID AND OSD_ACTIVEYN='Y' AND OSD_OS_ID=1
INNER JOIN PROJECT WITH(NOLOCK) ON PR_ID = OSD_PR_ID AND PR_ACTIVEYN = 'Y'
INNER JOIN [DBO].[TRANSFER_MASTER] WITH (NOLOCK) ON TM_ID=TIR_TRANS_TYPE_TM_ID AND TM_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH(NOLOCK) ON PR_ACG_ID= ACG_ID AND ACG_ACTIVEYN = 'Y'
INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON  UGM_ACTIVEYN='Y'   
INNER join APPUSER WITH(NOLOCK) ON UGM_UG_ID = AU_CUR_UG_ID and  UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y'
WHERE TM_CATG='TIRTYPE' AND TM_NAME='DEPUTATION' AND ACG_NAME = 'CIO' AND RS_CURR_LOCATION = 'Mumbai'
AND AU_USER_NAME = 'T02109AbacusDSM.TU01'</Query></Transfer9PersonnelNo>
	
	<SR_RRDwithoutSRTC01>
	<Query>
	SELECT distinct OSD_ID
       FROM(SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NULL 
       )sub
       WHERE rank=1
      </Query>
     </SR_RRDwithoutSRTC01>
     
    <SR_RRDwithoutSRTC03>
	<Query>
	SELECT distinct OSD_ID
       FROM
       (
       SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NULL 
       )sub
       WHERE rank=2
      </Query>
     </SR_RRDwithoutSRTC03>
  
    <SR_RRDwithoutSRTC04a>
	<Query>
	SELECT distinct OSD_ID
       FROM
       (
       SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NULL 
       )sub
       WHERE rank=3
      </Query>
     </SR_RRDwithoutSRTC04a>
     
     
     <SR_RRDwithoutSRTC04b>
	<Query>
	SELECT distinct OSD_ID
       FROM
       (
       SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NULL 
       )sub
       WHERE rank=4
      </Query>
     </SR_RRDwithoutSRTC04b>
     

    <SR_RRDWithSRTC02>
	<Query>
     SELECT distinct OSD_ID
       FROM
       (
       SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NOT NULL 
       )sub
       WHERE rank=1
       </Query>
     </SR_RRDWithSRTC02>
     
    <SR_RRDWithSRTC07>
	<Query>
     SELECT distinct OSD_ID
       FROM
       (
       SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NOT NULL 
       )sub
       WHERE rank=2
       </Query>
     </SR_RRDWithSRTC07>rl_id=osd_rl_id     
     
      <RRD_InactiveSR>
	  <Query>
      SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS
      INNER JOIN REQUISITION on RQ_OSD_ID=OSD_ID and OSD_ACTIVEYN='Y' and OSD_OS_ID=1
      INNER JOIN RESLEVELMASTER ON RL_ID=OSD_RL_ID and RL_ACTIVEYN='Y' 
      WHERE RQ_ACTIVEYN='N' AND RQ_STATUS='O' and RL_NAME NOT IN ('12','13') 
      ORDER BY 1 DESC
      </Query>
      </RRD_InactiveSR>
     
    <SR_RRDWithSRTC03>
	<Query>
     SELECT distinct OSD_ID
       FROM
       (
       SELECT  OSD_ID,dense_rank() over(order by osd_id DESC) rank
       FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
       INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
       ON SC_OSD_ID=OSD_ID AND OSD_ID NOT IN (1) AND OSD_OS_ID=1 AND OSD_ACTIVEYN='Y' AND OSD_RTHL_YN='Y' AND SC_ACTIVE_YN='Y'
       WHERE SC_RQ_NO IS NOT NULL 
       )sub
       WHERE rank=3
       </Query>
     </SR_RRDWithSRTC03>
     
     <SR_ApprovedByDMT>
	<Query>
     SELECT TOP 1 RQ_NO FROM REQUISITION  WITH (NOLOCK) 
     WHERE RQ_DMT_APPTYPE_SM_ID NOT IN (SELECT SM_ID FROM STATUSMASTER WHERE SM_TYPE='SR_APPROVAL_TYPE' AND SM_NAME='APPROVED BY DMT') 
     ORDER BY 1 DESC
     </Query>
     </SR_ApprovedByDMT>
     
     
    <SR_InactiveSR>
	<Query>
     SELECT TOP 1 RQ_NO FROM REQUISITION WITH (NOLOCK) WHERE RQ_ACTIVEYN='N'
     </Query>
     </SR_InactiveSR>
     
    <SR_TC37>
	<Query>
    SELECT TOP 1 RQ_NO FROM REQUISITION WITH (NOLOCK) WHERE RQ_ACTIVEYN='Y' AND RQ_STATUS='O'
    </Query>
    </SR_TC37>
	
     <SR_SearchSRPage>
     <Query>
     SELECT TOP 1 RQ_NO FROM REQUISITION WHERE RQ_ACTIVEYN='Y' AND RQ_STATUS='O'
     </Query>
     </SR_SearchSRPage>
     
     
  <SR_RRDRHLN>
  <Query>
    SELECT TOP 1 OSD_ID 
    FROM SCHEDULING_COMMITMENT_DATE  WITH (NOLOCK)
    INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) 
    ON SC_OSD_ID=OSD_ID 
    AND OSD_OS_ID=1 
    AND OSD_RTHL_YN='N'
    AND OSD_ACTIVEYN='Y'
    WHERE SC_RQ_NO IS NULL 
  </Query>
  </SR_RRDRHLN>
  
  
  <SR_BenchSR>
  <Query>
   SELECT TOP 1 RQ_NO FROM REQUISITION  WITH (NOLOCK)
   WHERE RQ_APP_STATUS NOT IN (SELECT SM_ID FROM STATUSMASTER 
							WHERE SM_TYPE='SR_APPROVAL_TYPE' AND SM_NAME='APPROVED BY DMT') 
   AND RQ_OSD_ID = 1
   ORDER BY 1 DESC 
  </Query>
  </SR_BenchSR>
  
  
   <SR_ProjectSR>
  <Query>
SELECT TOP 1 RQ_NO 
FROM REQUISITION  WITH (NOLOCK) 
INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) ON RQ_OSD_ID = OSD_ID 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y' 
WHERE RQ_APP_STATUS NOT IN (SELECT SM_ID FROM STATUSMASTER WHERE SM_TYPE='SR_APPROVAL_TYPE' AND SM_NAME='APPROVED BY DMT') 
AND ACG_NAME = 'CIO'
AND DU_NO = 'CIO05'
AND RQ_OSD_ID != 1
AND OSD_OS_ID = 1
AND OSD_ACTIVEYN = 'Y'
ORDER BY 1 DESC
  </Query>
  </SR_ProjectSR>
  
  
     <TagSupplyRRD>
	<Query>SELECT OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK)  
			INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID=OSD_RL_ID
			WHERE OSD_OS_ID=1 AND RL_NAME IN ('5','6','7') AND OSD_ACTIVEYN='Y'</Query>
     
     </TagSupplyRRD> 
     
      <RejectionRRD>

              <Query>SELECT  DISTINCT top 1 OSD_ID--,rs_personnel_no,acg_id,RS_ALLOCATED_AG,pr_acg_id
 FROM  APPUSER WITH (NOLOCK) 
 INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y' AND UGM_ACTIVEYN='Y'
 INNER JOIN DUMASTER WITH (NOLOCK) ON DU_ID=UGM_DETAIL_ID AND DU_ACTIVEYN='Y'  -- AND UGM_UG_ID IN (4,11)
 INNER JOIN RESOURCE WITH (NOLOCK) ON DU_NO=RS_DU_NO
 INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
 INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
 INNER JOIN RESPROJECTS WITH (NOLOCK) ON RS_ID=RP_RS_ID AND RP_CURR_YN='Y' AND RS_RL_ID=3
 INNER JOIN PROJECT WITH (NOLOCK) ON PR_ID=RP_PR_ID AND PR_ACTIVEYN='Y' and acg_id=PR_ACG_ID
 INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK)  ON OSD_ID=RP_OSD_ID AND OSD_ACTIVEYN='Y'
 INNER JOIN RESLEVELMASTER ON RS_RL_ID=RL_ID AND RL_ACTIVEYN='Y' AND RL_NAME='12'
  WHERE ACG_ID=25 AND OSD_OS_ID = 1 
</Query>
     
     </RejectionRRD>

          <RejectionPersonalNumber>
              <Query>SELECT TOP 1 from RRD_RESOURCE_TAGGING 
              inner join opsourcingdetails on RRT_OSD_ID=osd_id
              where RRT_SM_ID=221 and RRT_ACTIVEYN='y' and osd_Activeyn='y' and OSD_CLNT_INT_REQD='y' and osd_os_id=1</Query>
     </RejectionPersonalNumber>  
     
     
       <MatchingRoleRRD>
    
    <Query>	SELECT TOP 1 OSD_ID FROM OPSOURCINGDETAILS WITH (NOLOCK) 
			WHERE OSD_OS_ID=1 AND OSD_OS_ID!=5 AND OSD_ACTIVEYN='Y' AND OSD_RL_ID =7
			ORDER BY 1 DESC  
    </Query>
   
   </MatchingRoleRRD> 
   
   <RoleRightMatrix>
              <Query>declare @V_TODAY datetime set @V_TODAY=getdate()-14 select top 10 osd_id  from OPSOURCINGDETAILS
  inner join    PROJECTWORKLOCATIONMASTER WITH ( NOLOCK ) ON PWL_ID = OSD_PWL_ID AND    PWL_ACTIVEYN='Y'INNER JOIN DBO.RESLEVELMASTER WITH(NOLOCK) ON OSD_RL_ID = RL_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'	
 where PWL_NAME not in ('TBD - TBD','Client Onsite - Within India','Client Onsite - Out of India')
 AND  RL_name ='12' 
 AND OSD_RTHL_YN='Y'
 AND OSD_ACTIVEYN='Y'
 AND osd_os_id=1 
 AND ACG_NAME='CIO'
 AND DU_NO='CIO05'
 AND PR_ID ='17855'
 AND convert(date,OSD_RTHL_CHANGED_DATE)&lt;convert(date,@V_TODAY) order by 1 desc
</Query>
     </RoleRightMatrix>  
     
     <ChangeRollOff3>
      <Query>
        DECLARE @V_CURR BIGINT ,
            @V_START_DATE BIGINT ,
            @ROV_START_DATE DATE ,
            @ROV_END_30 DATE ,
            @ROV_END_90 DATE ,
            @ROV_END_15 DATE ,
            @ROV_END_45 DATE ,
            @ROV_END_60 DATE,
   @V_CURR_2 DATE

        SET @V_CURR = DATEPART(DD, GETDATE()) 
  SET @V_CURR_2  = DATEADD(MM,2,GETDATE())
                                           
        IF ( @V_CURR &lt; 16 ) 
            BEGIN
                SET @V_START_DATE = 1
            END 
        ELSE 
            BEGIN
                SET @V_START_DATE = 16
            END 

        SET @ROV_START_DATE = ( SELECT  CONVERT(DATETIME, ( DATEFROMPARTS(DATEPART(YY,
                                                              GETDATE()),
                                                              DATEPART(MM,
                                                              GETDATE()),
                                                              @V_START_DATE) ))
                              )

--SELECT @ROV_START_DATE
        IF ( @V_START_DATE = 1 ) 
            BEGIN
                SET @ROV_END_15 = DATEADD(DD, 15, @ROV_START_DATE)
                SET @ROV_END_45 = DATEADD(DD, 15,
                                          DATEADD(MM, 1, @ROV_START_DATE))  
            END
        ELSE 
            BEGIN
                SET @ROV_END_15 = ( SELECT  CONVERT(DATETIME, ( DATEFROMPARTS(DATEPART(YY,  
                                                              DATEADD(MM,1 ,GETDATE())),  
                                                         DATEPART(MM,  
                                                              DATEADD(MM,1 ,GETDATE())),  
                                                              1) ))  
                                  )
                                 
                SET @ROV_END_45 = DATEADD(DD, -15,
                                          DATEADD(MM, 2, @ROV_START_DATE))           
                       
            END                 
        SET @ROV_END_30 = DATEADD(MM, 1, @ROV_START_DATE)
        SET @ROV_END_60 = DATEADD(MM, 2, @ROV_START_DATE)
        SET @ROV_END_90 = DATEADD(MM, 3, @ROV_START_DATE)

  --SELECT @ROV_END_45 [45],@ROV_END_90 [90]

 SELECT RP_RS_ID,RS_ID,RS_PERSONNEL_NO,RS_NAME,RS_DU_NO,CONVERT(DATE,RP_LOCK_END) RP_LOCK_END,RP_LOCK_START,
 @ROV_START_DATE ROV_START,@ROV_END_45 ROV_END_45,@ROV_END_90 ROV_END_90,RP_LOCK_TYPE,RP_CURR_YN 
 INTO #ROV_WITHIN 
 FROM  APPUSER WITH (NOLOCK) 
 INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y' AND UGM_ACTIVEYN='Y'  AND UGM_UG_ID=1
 INNER JOIN DUMASTER WITH (NOLOCK) ON DU_ID=UGM_DETAIL_ID AND DU_ACTIVEYN='Y' 
 INNER JOIN RESOURCE WITH (NOLOCK) ON DU_NO=RS_DU_NO
 INNER JOIN  RESPROJECTS WITH (NOLOCK) ON RS_ID=RP_RS_ID 
 -- AND RP_CURR_YN='Y' 
 INNER JOIN  OPSOURCINGDETAILS WITH (NOLOCK) ON RP_OSD_ID=OSD_ID
 INNER JOIN RATETYPEMASTER WITH (NOLOCK) ON RT_ID=OSD_RT_ID AND RT_ACTIVEYN='Y'
 WHERE 
  ((CONVERT(DATE,RP_LOCK_END) &lt; @ROV_END_45 AND CONVERT(DATE,RP_LOCK_END) &gt; @ROV_START_DATE AND RT_SCH_PERIOD=45)
  OR (CONVERT(DATE,RP_LOCK_END) &lt; @ROV_END_90 AND CONVERT(DATE,RP_LOCK_END) &gt; @ROV_START_DATE AND RT_SCH_PERIOD=90)
   )
  --AND RP_CURR_YN='Y'
  --AND RP_RS_ID=126554 
   --AND AU_PERSONNEL_NO='ASHOK.VIRA'


--SELECT DISTINCT RS_PERSONNEL_NO FROM #ROV_WITHIN WHERE RP_LOCK_TYPE='S' AND RP_CURR_YN='F'
SELECT DISTINCT TOP 1 RS_PERSONNEL_NO FROM #ROV_WITHIN WHERE  RP_LOCK_END> @V_CURR_2 AND RP_LOCK_TYPE='H' AND RP_CURR_YN='F'
DROP TABLE #ROV_WITHIN
      
      </Query>
     </ChangeRollOff3>
     
     <ChangeRollOff4>
     <Query>  
        DECLARE @V_CURR BIGINT ,
            @V_START_DATE BIGINT ,
            @ROV_START_DATE DATE ,
            @ROV_END_30 DATE ,
            @ROV_END_90 DATE ,
            @ROV_END_15 DATE ,
            @ROV_END_45 DATE ,
            @ROV_END_60 DATE,
   @V_CURR_2 DATE

        SET @V_CURR = DATEPART(DD, GETDATE()) 
  SET @V_CURR_2  = DATEADD(MM,2,GETDATE())
                                           
        IF ( @V_CURR &lt; 16 ) 
            BEGIN
                SET @V_START_DATE = 1
            END 
        ELSE 
            BEGIN
                SET @V_START_DATE = 16
            END 

        SET @ROV_START_DATE = ( SELECT  CONVERT(DATETIME, ( DATEFROMPARTS(DATEPART(YY,
                                                              GETDATE()),
                                                              DATEPART(MM,
                                                              GETDATE()),
                                                              @V_START_DATE) ))
                              )

--SELECT @ROV_START_DATE
        IF ( @V_START_DATE = 1 ) 
            BEGIN
                SET @ROV_END_15 = DATEADD(DD, 15, @ROV_START_DATE)
                SET @ROV_END_45 = DATEADD(DD, 15,
                                          DATEADD(MM, 1, @ROV_START_DATE))  
            END
        ELSE 
            BEGIN
                SET @ROV_END_15 = ( SELECT  CONVERT(DATETIME, ( DATEFROMPARTS(DATEPART(YY,  
                                                              DATEADD(MM,1 ,GETDATE())),  
                                                         DATEPART(MM,  
                                                              DATEADD(MM,1 ,GETDATE())),  
                                                              1) ))  
                                  )
                                 
                SET @ROV_END_45 = DATEADD(DD, -15,
                                          DATEADD(MM, 2, @ROV_START_DATE))           
                       
            END                      
                              
                              
              
        SET @ROV_END_30 = DATEADD(MM, 1, @ROV_START_DATE)
        SET @ROV_END_60 = DATEADD(MM, 2, @ROV_START_DATE)
        SET @ROV_END_90 = DATEADD(MM, 3, @ROV_START_DATE)

  --SELECT @ROV_END_45 [45],@ROV_END_90 [90]

 SELECT RP_RS_ID,RS_ID,RS_PERSONNEL_NO,RS_NAME,RS_DU_NO,CONVERT(DATE,RP_LOCK_END) RP_LOCK_END,RP_LOCK_START,@ROV_START_DATE ROV_START,@ROV_END_45 ROV_END_45,@ROV_END_90 ROV_END_90,RP_LOCK_TYPE, RP_CURR_YN
 INTO #ROV_WITHIN 
 FROM  APPUSER WITH (NOLOCK) 
 INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y' AND UGM_ACTIVEYN='Y'  AND UGM_UG_ID=4
 INNER JOIN DUMASTER WITH (NOLOCK) ON DU_ID=UGM_DETAIL_ID AND DU_ACTIVEYN='Y' 
 INNER JOIN RESOURCE WITH (NOLOCK) ON DU_NO=RS_DU_NO
 INNER JOIN  RESPROJECTS WITH (NOLOCK) ON RS_ID=RP_RS_ID 
 -- AND RP_CURR_YN='Y' 
 INNER JOIN  OPSOURCINGDETAILS WITH (NOLOCK) ON RP_OSD_ID=OSD_ID
 INNER JOIN RATETYPEMASTER WITH (NOLOCK) ON RT_ID=OSD_RT_ID AND RT_ACTIVEYN='Y'
 WHERE 
 ((CONVERT(DATE,ISNULL(RP_LOCK_END,RP_LOCK_START))&lt; @ROV_END_45 AND CONVERT(DATE,ISNULL(RP_LOCK_END,RP_LOCK_START))&gt;@ROV_START_DATE AND RT_SCH_PERIOD=45)
  OR (CONVERT(DATE,ISNULL(RP_LOCK_END,RP_LOCK_START))&lt; @ROV_END_90 AND CONVERT(DATE,ISNULL(RP_LOCK_END,RP_LOCK_START))&gt;@ROV_START_DATE AND RT_SCH_PERIOD=90)
   ) 
  --AND RP_CURR_YN='Y'
  --AND RP_RS_ID=126554 
   --AND AU_PERSONNEL_NO='ASHOK.VIRA'


SELECT DISTINCT TOP 1 RS_PERSONNEL_NO FROM #ROV_WITHIN WHERE RP_LOCK_TYPE='S' AND RP_CURR_YN='F'
--SELECT DISTINCT RS_PERSONNEL_NO FROM #ROV_WITHIN WHERE  RP_LOCK_END> @V_CURR_2
DROP TABLE #ROV_WITHIN
     </Query>
     </ChangeRollOff4>
     
     <ChangeRollOff5>
     <Query>
     DECLARE  @V_CURR_2 DATE= DATEADD(DD,2,GETDATE())
SELECT DISTINCT RS_PERSONNEL_NO 
FROM  APPUSER WITH (NOLOCK) 
INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y' AND UGM_ACTIVEYN='Y'
INNER JOIN DUMASTER WITH (NOLOCK) ON DU_ID=UGM_DETAIL_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESOURCE WITH (NOLOCK) ON DU_NO=RS_DU_NO 
INNER JOIN  RESPROJECTS WITH (NOLOCK) ON RS_ID=RP_RS_ID
INNER JOIN SUBLOCKREQUEST WITH (NOLOCK) ON SLR_RS_ID=RS_ID
INNER JOIN LOCKREQUEST WITH (NOLOCK) ON SLR_LR_ID=LR_ID
WHERE (RP_LOCK_TYPE='S' AND RP_CURR_YN='F') AND (LR_SM_ID IN (1,2)) AND UGM_UG_ID=4 AND RP_LOCK_END>@V_CURR_2
     </Query></ChangeRollOff5>
     <ChangeRollOff9>
     <Query>
     SELECT DISTINCT RS_PERSONNEL_NO
 FROM  APPUSER WITH (NOLOCK) 
 INNER JOIN USERGROUPMEMBER WITH (NOLOCK) ON UGM_AU_ID=AU_ID AND AU_ACTIVEYN='Y' AND UGM_ACTIVEYN='Y'
 INNER JOIN DUMASTER WITH (NOLOCK) ON DU_ID=UGM_DETAIL_ID AND DU_ACTIVEYN='Y'  AND UGM_UG_ID=4
 INNER JOIN RESOURCE WITH (NOLOCK) ON DU_NO=RS_DU_NO 
 INNER JOIN [DBO].[TRANSFER_DETAILS] WITH (NOLOCK) ON TIR_RS_ID=RS_ID
 --INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) ON TIR_OSD_ID=OSD_ID AND OSD_ACTIVEYN='Y' AND OSD_OS_ID=1
 INNER JOIN [DBO].[TRANSFER_MASTER] WITH (NOLOCK) ON TM_ID=TIR_TRANS_TYPE_TM_ID AND TM_ACTIVEYN='Y'
WHERE TM_CATG='TIRTYPE' AND TM_NAME='DEPUTATION' 
     </Query>
     </ChangeRollOff9>
     
     <TopSearchCandidateID>
     <Query>
     SELECT TOP 100 ('C'+Convert(nvarchar(50), RCN_ID)) FROM DBO.REC_CANDIDATE  WITH (NOLOCK)
     </Query></TopSearchCandidateID>
     
     <TopSearchPersonnelNo>
     <Query>select top 1 RS_Personnel_no
from resource with(NOLOCK)
inner join RESPROJECTS with(NOLOCK)on rs_id = rp_rs_id and rp_lock_type = 'S'
Where rp_curr_yn in ('Y','F') and rp_osd_id != 1
order by RS_Personnel_no  DESC</Query></TopSearchPersonnelNo>
     

<ActiveRRD_CIO>
   <Query>SELECT TOP 1 OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
	--AND OSD_OS_ID!=5 
	AND RL_NAME='10'
	AND Ol_name='Mumbai'
	AND ACG_NAME='CIO'
	AND DU_NO='CIO05'
	AND OSD_ACTIVEYN='Y' 
	AND OSD_RTHL_YN='Y'
	AND OSD_ID IS NOT NULL
ORDER BY 1 DESC </Query>>
   </ActiveRRD_CIO>
   
  <ActiveRRD_RES>
   <Query>SELECT TOP 1 OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
	--AND OSD_OS_ID!=5 
     AND RL_NAME='10'
	 AND Ol_name='Mumbai'
	 AND ACG_NAME='RES'
	--AND DU_NO='HPS-EALA-OM-05'
	AND OSD_ACTIVEYN='Y' 
	AND OSD_RTHL_YN='Y'
	AND OSD_ID IS NOT NULL
ORDER BY 1 DESC  </Query>
   </ActiveRRD_RES>
   
      
 <ActiveRRD_AVANADE>
   <Query>SELECT TOP 1 OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
	--AND OSD_OS_ID!=5 
     AND RL_NAME='10'
	 AND Ol_name='Mumbai'
	 AND ACG_NAME='AVANADE'
	--AND DU_NO='HPS-EALA-OM-05'
	AND OSD_ACTIVEYN='Y' 
	AND OSD_RTHL_YN='Y'
	AND OSD_ID IS NOT NULL
ORDER BY 1 DESC  </Query>
   </ActiveRRD_AVANADE>
   
    <ActiveRRD_FS>
   <Query>SELECT TOP 1 OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = OSD_OL_ID AND OL_ACTIVEYN='Y'
WHERE OSD_OS_ID=1 
	--AND OSD_OS_ID!=5 
     AND RL_NAME='10'
	 AND Ol_name='Mumbai'
	 AND ACG_NAME='FS'
	--AND DU_NO='HPS-EALA-OM-05'
	AND OSD_ACTIVEYN='Y' 
	AND OSD_RTHL_YN='Y'
	AND OSD_ID IS NOT NULL
ORDER BY 1 DESC  </Query>
   </ActiveRRD_FS>
   
 <BenchResource>
 <Query>SELECT TOP 1 RS_PERSONNEL_NO--,ACG_NAME ,DU_NO
FROM RESOURCE WITH (NOLOCK) 
INNER JOIN RESPROJECTS WITH (NOLOCK)  ON RP_RS_ID=RS_ID
INNER JOIN PROJECT     WITH (NOLOCK)  ON RP_PR_ID=PR_ID 
INNER JOIN DUMASTER    WITH (NOLOCK)  ON RS_DU_NO=DU_NO AND DU_ACTIVEYN='Y'
INNER JOIN DGMASTER WITH (NOLOCK) ON DG_ID=DU_DG_ID AND DG_ACTIVEYN='Y'
INNER JOIN AGMASTER WITH (NOLOCK) ON ACG_ID=DG_ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = RS_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN OFFICE_LOC_MASTER WITH (NOLOCK)  ON OL_ID = RS_OL_ID AND OL_ACTIVEYN='Y'
WHERE RL_NAME='10'
	AND Ol_name='Mumbai'
	AND ACG_NAME='FS'
	--AND DU_NO='CIO05'	
	AND RS_STATUS ='O'
	AND RP_OSD_ID=1
ORDER BY 1 DESC</Query>>
 </BenchResource>  
   
  <GFT>
  <Query>
 select top 1 rs_personnel_no
 from resource with(nolock)
 inner join resprojects with(nolock) on rs_id = rp_rs_id
 inner join project with(nolock) on rs_project = pr_name
 inner join agmaster prag with(nolock) on pr_acg_id = prag.acg_id
 inner join reslevelmaster with(nolock) on rs_rl_id = rl_id
 inner join office_loc_master with(nolock) on rs_ol_id = ol_id 
 inner join agmaster rsag with(nolock) on rs_allocated_ag= rsag.acg_id
 where prag.acg_name = 'Training'
 and (isnull(RS_ALLOCATED_AG,'') != '' AND rsag.acg_name != 'CIO')
 and rl_name = '12'
 and ol_name = 'Mumbai' 
 and rs_status = 'O'
 and rp_osd_id = 1
 order by 1 desc
 </Query>
 </GFT>
 
<RRD_GFT>
<Query>
select top 1 osd_id
from opsourcingdetails with(nolock)
inner join project with(nolock) on osd_pr_id = pr_id
inner join reslevelmaster with(nolock) on osd_rl_id = rl_id
inner join agmaster with(nolock) on pr_acg_id = acg_id
inner join office_loc_master with(nolock) on osd_ol_id = ol_id 
where osd_os_id = 1 and osd_activeyn = 'Y'
and acg_name = 'CIO'
and rl_name = '12'
and ol_name ='Mumbai'
and OSD_RTHL_YN = 'Y'
order by 1 desc
</Query>
</RRD_GFT>
  
  
     
     <LockingAllocatedIG>
     <Query>
     SELECT TOP 1 RS_PERSONNEL_NO ,RS_ALLOCATED_AG
FROM RESOURCE 
INNER JOIN RESLEVELMASTER ON RS_RL_ID=RL_ID AND RL_ACTIVEYN='Y'
INNER JOIN RESPROJECTS ON RS_ID = RP_RS_ID AND RP_CURR_YN = 'Y' 
INNER JOIN PROJECT ON RP_PR_ID = PR_ID 
WHERE   RS_CURR_YN = 'Y'  AND RP_LOCK_TYPE = 'H' AND RS_STATUS = 'O' AND PR_ACG_ID = 25 
 AND RL_NAME='12' AND ISNULL(RS_ALLOCATED_AG,0)=0
     </Query></LockingAllocatedIG>
     
     <LockingFIFORestricted>
     <Query>
SELECT DISTINCT TOP 1 OSD_ID FROM RESOURCE_BENCH_AGE 
INNER JOIN RESPROJECTS WITH (NOLOCK) ON RBA_RS_ID=RP_RS_ID --AND RP_CURR_YN='Y'
INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) ON RP_OSD_ID=OSD_ID AND OSD_ACTIVEYN='Y'
WHERE RBA_BENCH_AGE > 30 AND OSD_ID != 1 AND OSD_OS_ID=1
     </Query></LockingFIFORestricted>
     
    <LockinghardlockSSL>
    <Query>
    SELECT distinct R1.RS_PERSONNEL_NO,R1.RS_ID,R1.RS_RL_ID,R1.RS_OL_ID ,RSK1.RSS_SI_ID,RBA_BENCH_AGE
	into #tmp_RS
	FROM RESOURCE R1 WITH (NOLOCK)
	INNER JOIN RESOURCESKILLS RSK1 WITH (NOLOCK) ON RSK1.RSS_RS_ID=R1.RS_ID AND RSK1.RSS_SI_LEVEL_ID=5 AND RSK1.RSS_PRIMARY_YN='Y'
	INNER JOIN RESOURCE_BENCH_AGE WITH (NOLOCK) ON RBA_RS_ID=R1.RS_ID
	where not exists(select 1 from rej_ref_details where rej_ref_rs_id=R1.rs_id) AND R1.RS_PERSONNEL_NO IS NOT NULL
	
	select distinct TOP 1 RP_OSD_ID --distinct main.*,RP_OSD_ID 
	from 
	(
	select *,count(sub.RS_PERSONNEL_NO) over(partition by sub.RSS_SI_ID,sub.RS_RL_ID,sub.RS_OL_ID,sub.RBA_BENCH_AGE) cntRS from 
	(
	SELECT DISTINCT TOP 1000 R1.RS_PERSONNEL_NO,R1.RSS_SI_ID,
	R1.RS_RL_ID,R1.RS_OL_ID,R1.RBA_BENCH_AGE--,
	count(distinct R1.RS_PERSONNEL_NO) over(partition by R1.RSS_SI_ID,
	R1.RS_RL_ID,R1.RS_OL_ID,R1.RBA_BENCH_AGE) cntRS
	from #tmp_RS R1 
	INNER JOIN #tmp_RS R2  ON R1.RSS_SI_ID=R2.RSS_SI_ID AND R1.RS_RL_ID=R2.RS_RL_ID AND R1.RS_OL_ID=R2.RS_OL_ID 
	AND R1.RBA_BENCH_AGE=R2.RBA_BENCH_AGE 
	--GROUP BY R1.RSS_SI_ID,R1.RS_RL_ID,R1.RS_OL_ID,R1.RBA_BENCH_AGE
	) sub
	)main
	INNER JOIN RESOURCE RS WITH (NOLOCK) ON main.RS_PERSONNEL_NO=RS.RS_PERSONNEL_NO
	INNER JOIN RESPROJECTS WITH (NOLOCK) ON RS.RS_ID=RP_RS_ID
	INNER JOIN OPSOURCINGDETAILS WITH (NOLOCK) ON RP_OSD_ID=OSD_ID AND OSD_ACTIVEYN='Y' AND OSD_OS_ID=1 AND OSD_ID!=1
	where main.cntRS=2
	
	drop table #tmp_RS
    </Query>
    </LockinghardlockSSL>
     <RRFEmailTo>
              <Query>select top 1 createdttm,* from maillogdetails where MAILSUBJECT like
'%GCP Demand Received 31164 - Abacus GDN Tech Demand Supply Ma%'  order by 1 desc</Query>
     </RRFEmailTo>
     <RRFEmailCC>
              <Query>select top 1 createdttm,* from maillogdetails where MAILSUBJECT like
'%GCP Demand Received 31164 - Abacus GDN Tech Demand Supply Ma%'  order by 1 desc</Query>
     </RRFEmailCC>
     <RRFEmailSubject>
              <Query>select top 1 createdttm,* from maillogdetails where MAILSUBJECT like
'%GCP Demand Received 31164 - Abacus GDN Tech Demand Supply Ma%'  order by 1 desc</Query>
     </RRFEmailSubject>
     <RRFEmailBody>
              <Query>select top 1 createdttm,* from maillogdetails where MAILSUBJECT like
'%GCP Demand Received 31164 - Abacus GDN Tech Demand Supply Ma%'  order by 1 desc</Query>
     </RRFEmailBody> 
     
    
<MatchingScoreTC01>
              <Query>SELECT DISTINCT TOP 1  ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
              FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN DBO.OPSOURCINGSKILLS WITH ( NOLOCK ) ON OPS_OSD_ID = OSD_ID AND OPS_PRIMARY_YN = 'Y' and OPS_SI_LEVEL_ID = 5
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='11'
                AND ACG_NAME='CIO'
               -- AND DU_NO='CIO05'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
				AND OPS_SI_NAME = 'Functional Test Planning'
				AND NOT EXISTS (SELECT OPS_OSD_ID FROM OPSOURCINGSKILLS WHERE OSD_ID = OPS_OSD_ID AND OPS_PRIMARY_YN = 'N' AND OPS_SI_LEVEL_ID =5)
ORDER BY 1 DESC</Query>
     </MatchingScoreTC01>




<MatchingScoreTC02>
              <Query>SELECT DISTINCT TOP 1  ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN DBO.OPSOURCINGSKILLS WITH ( NOLOCK ) ON OPS_OSD_ID = OSD_ID AND OPS_PRIMARY_YN = 'Y' and OPS_SI_LEVEL_ID = 5
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='11'
                AND ACG_NAME='CIO'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
				AND OPS_SI_NAME = 'Functional Test Planning'
				AND EXISTS (SELECT count(OPS_OSD_ID) FROM OPSOURCINGSKILLS WHERE OSD_ID = OPS_OSD_ID AND OPS_PRIMARY_YN = 'N' AND OPS_SI_LEVEL_ID =5 having count(OPS_OSD_ID) = 1)
ORDER BY 1 DESC</Query>
     </MatchingScoreTC02>

<MatchingScoreTC03>
              <Query>SELECT DISTINCT TOP 1  ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN DBO.OPSOURCINGSKILLS WITH ( NOLOCK ) ON OPS_OSD_ID = OSD_ID AND OPS_PRIMARY_YN = 'Y' and OPS_SI_LEVEL_ID = 5
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='11'
                AND ACG_NAME='CIO'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
				AND OPS_SI_NAME = 'Functional Test Planning'
				AND EXISTS (SELECT count(OPS_OSD_ID) FROM OPSOURCINGSKILLS WHERE OSD_ID = OPS_OSD_ID AND OPS_PRIMARY_YN = 'N' AND OPS_SI_LEVEL_ID =5 having count(OPS_OSD_ID) = 2)
ORDER BY 1 DESC</Query>
     </MatchingScoreTC03>

<MatchingScoreTC04>
              <Query>SELECT DISTINCT TOP 1  ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
FROM OPSOURCINGDETAILS WITH (NOLOCK) 
INNER JOIN PROJECT     WITH (NOLOCK)  ON OSD_PR_ID=PR_ID 
INNER JOIN AGMASTER    WITH (NOLOCK)  ON PR_ACG_ID=ACG_ID AND ACG_ACTIVEYN='Y'
INNER JOIN DGMASTER    WITH (NOLOCK)  ON DG_ACG_ID=ACG_ID AND DG_ACTIVEYN='Y'
INNER JOIN DUMASTER    WITH (NOLOCK)  ON DU_DG_ID=DG_ID AND DU_ACTIVEYN='Y'
INNER JOIN RESLEVELMASTER WITH (NOLOCK)  ON RL_ID = OSD_RL_ID and rl_ACTIVEYN='Y'
INNER JOIN DBO.OPSOURCINGSKILLS WITH ( NOLOCK ) ON OPS_OSD_ID = OSD_ID AND OPS_PRIMARY_YN = 'Y' and OPS_SI_LEVEL_ID = 5
WHERE OSD_OS_ID=1 
                AND OSD_OS_ID!=5 
                AND RL_NAME='11'
                AND ACG_NAME='CIO'
                AND OSD_ACTIVEYN='Y' 
                AND OSD_RTHL_YN='Y'
                AND OSD_ID IS NOT NULL
				AND OPS_SI_NAME = 'Functional Test Planning'
				AND EXISTS (SELECT count(OPS_OSD_ID) FROM OPSOURCINGSKILLS WHERE OSD_ID = OPS_OSD_ID AND OPS_PRIMARY_YN = 'N' AND OPS_SI_LEVEL_ID =5 having count(OPS_OSD_ID) = 3)
ORDER BY 1 DESC</Query>
     </MatchingScoreTC04> 
     
     
<LockingIOMEnterpriseID>
              <Query>Select top 1 rs_personnel_no
from resource with(NOLOCK)
inner join RESPROJECTS with(NOLOCK) on rs_id= rp_rs_id
where rp_osd_id = 1 and rp_curr_yn = 'Y' and RS_CURR_YN = 'Y'
order by 1 desc</Query>
     </LockingIOMEnterpriseID> 
     
     <LockingIOMRRD>
              <Query>select top 1 osd_id
from OPSOURCINGDETAILS with(NOLOCK)
inner join office_loc_master with(NOLOCK) on osd_ol_id = ol_id
inner join general_config_details with(NOLOCK) on osd_rrd_type_gcd_id = gcd_id
where osd_os_id = 1 and osd_activeyn = 'Y'
and convert(date,OSD_END_DATE) > GETDATE()
and ol_name = 'BENGALURU'
and gcd_name = 'Internal Organizational Movement' and gcd_grp_name = 'RRD Types' and gcd_activeyn = 'Y'
order by 1 desc</Query>
     </LockingIOMRRD> 
   
  <LockingGFT-IGBlank> 
   <Query>
select top 1 rs_personnel_no
from resource with(nolock)
inner join project with(nolock) on rs_project = pr_name
inner join agmaster with(nolock) on pr_acg_id = acg_id
inner join reslevelmaster with(nolock) on rs_rl_id = rl_id
inner join office_loc_master with(nolock) on rs_ol_id = ol_id
where isnull(RS_ALLOCATED_AG,'') = ''
and acg_name = 'Training'
and rl_name = '12'
and ol_name = 'Bengaluru'
and rs_status = 'O'
order by 1 desc
     </Query>
     </LockingGFT-IGBlank> 
     
     
     <LockingGFTSameIG> 
   <Query>select top 1 ('R'+Convert(nvarchar(50),OSD_ID)) as OSD_ID
from opsourcingdetails with(nolock)
inner join project with(nolock) on osd_pr_id = pr_id
inner join office_loc_master with(nolock) on osd_ol_id = ol_id
inner join reslevelmaster with(nolock) on osd_rl_id = rl_id
inner join agmaster with(nolock) on pr_acg_id = acg_id
where osd_os_id = 1 and osd_activeyn = 'Y'
--and acg_name= 'CIO'
and rl_name = '12'
and ol_name = 'Mumbai'
and OSD_INF_SERV_YN ='N'
order by 1 desc
</Query>
     </LockingGFTSameIG> 
 <LockingGFTSameIGPersonnelNo> 
   <Query>
Select top 1 rs_personnel_no
from resource with(NOLOCK)
inner join project with(nolock) on rs_project = pr_name
inner join agmaster with(nolock) on pr_acg_id = acg_id
inner join reslevelmaster with(nolock) on rs_rl_id = rl_id
inner join office_loc_master with(nolock) on rs_ol_id = ol_id
--and acg_name= 'CIO'
and rl_name = '12'
and ol_name = 'Mumbai'
and RS_INF_SERV_YN ='N'
and RS_StATUS = 'O'
order by 1 desc
     </Query>
     </LockingGFTSameIGPersonnelNo> 
     
     
      <LockingGFT-IGNOTBlank> 
   <Query>select top 1 rs_personnel_no
from resource with(nolock)
inner join project with(nolock) on rs_project = pr_name
inner join agmaster with(nolock) on pr_acg_id = acg_id
inner join reslevelmaster with(nolock) on rs_rl_id = rl_id
inner join office_loc_master with(nolock) on rs_ol_id = ol_id
where isnull(RS_ALLOCATED_AG,'') != ''
and acg_name = 'Training'
and rl_name = '12'
and ol_name = 'Bengaluru'
order by 1 desc
     </Query>
     </LockingGFT-IGNOTBlank> 
          
</class>
